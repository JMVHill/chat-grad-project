<!DOCTYPE html>
<html lang="en" ng-app="ChatApp">
<head>
    <meta charset="utf-8">
    <title>Chat</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.1/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="main.css">
    <script src="js/main.js"></script>
</head>
<body ng-controller="ChatController">

<a ng-show="!loggedIn" href="{{loginUri}}">Log in</a>

<section ng-show="loggedIn" style="height: 90%;">
    <nav class="navbar navbar-default navbar-inverse navbar-custom" style="margin-bottom: 3px;">
        <div class="navbar-header" style="text-align: center; float: none; margin-top: 7px;">
            <span style="color: whitesmoke; font-size: 150%;">Chat [{{user.name}}]</span>
        </div>
    </nav>
    <div style="display: flex; flex-direction: row; align-content: flex-start; height:98%;">
        <div id="user-list">
            <!--class="col-sm-4 col-sm-offset-1 col-md-4 col-md-offset-1 col-lg-4 col-md-offset-1"-->

            <!--<h2>User Listing</h2> <br/>-->
            <ul class="list-group" style="background-color: whitesmoke; height: 100%;">
                <li class="list-group-item chat-target-user-list" ng-repeat="user in users"
                    ng-click="setChatTarget(user)" ng-show="user.name || user.id" style="clear: both;">
                    {{user.name || user.id}}
                    <!--<button ng-click="setChatTarget(user)" style="float: right;">Chat!</button>-->
                    <span ng-show="userHasUnread(user)" class="badge">{{userUnreadCount(user)}}</span>
                </li>
            </ul>

        </div>
        <div id="chat-area">
            <div class="clearfix" id="chat-text-area">
                <div ng-show="currentConversation" ng-repeat="message in currentConversation.messages"
                     class="bubble"
                     ng-class="{true:'bubble-right', false:'bubble-left'}[message.from == userId]">
                    {{message.body}}
                </div>
            </div>
            <div class="clearfix"
                 style="align-self: flex-end; flex-grow:0; display: flex; flex-direction: row; width: 100%;">
                <form ng-submit="sendMessage()" class="clearfix"
                      style="align-self: flex-end; flex-grow:0; display: flex; flex-direction: row; width: 100%;">
                    <input ng-model="newMessage.body" type="text" style="flex-grow: 1; margin-right: 5px;"> </input>
                    <button type="submit" style="align-self: flex-end; flex-grow:0; margin-right: 5px;">
                        Send
                    </button>
                </form>
            </div>

        </div>

    </div>

</section>
</body>
</html>